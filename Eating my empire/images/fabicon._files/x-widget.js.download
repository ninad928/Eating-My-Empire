var productIdsFileData=[],deletedFileData=[],currentPageInPagination=1,deletedFileCreatedData=[],schemaData=[],tokenFileData=[],summaryFileData=[],widgetFileCount=[],alreadyLoadedWidgets=[],totalPageLinks=0,isForward=!0,lastDifferenceFactor=0,currentMaxToSkip=0,counter=1,smartWidgetsServerBaseUrl;smartWidgetsServerBaseUrl=null!=window._ekomiWidgetsServerUrl?window._ekomiWidgetsServerUrl:window._ekomiServerUrl;var a=1;function translateText(e,t,i){console.log(e),a=0,i.attr("disabled","disabled");var r=new XMLHttpRequest,n=new FormData;return n.append("text",e),n.append("crossDomain",!0),r.open("POST",window._ekomiWidgetsServerUrl+"/translate-data",!0),r.onload=function(){var a=JSON.parse(this.responseText).translate_text;t.addClass("text_translate_"+counter).html(a),t.after('<span class="trans_after trans_after_'+counter+'" hidden>'+a+"</span>"),t.after('<span class="trans_before trans_before_'+counter+'" hidden>'+e+"</span>"),counter++,i.removeAttr("disabled")},r.send(n),""}function getWidgetContainer(e,t,a){var i=e("#widget-container");return a&&(e(".ekomi-widget-"+t+".div_"+(a=a.trim().replace(/\./g,"-_dot_-").split("%").join("-_perc_-").split("/").join("-_slash_-").replace(/\s+/g,"-_-_").replace("+","plus").replace("(","brkt").replace(")","brkt").replace("{","brkt").replace("}","brkt").replace("[","brkt").replace("]","brkt").split(":").join("-coln-"))).length?i=e(".ekomi-widget-"+t+".div_"+a):e(".ekomi-widget-"+t).length&&(i=e(".ekomi-widget-"+t))),i}!function(){window.ekomiWidgetJquery;var jqueryVersion="3.1.0",maxCallCount=1,defaultRetryTime=5e3,oldToken="",smartWidgetsServercloudFrontUrl;smartWidgetsServercloudFrontUrl=void 0!==window._ekomiWidgetsServerUrl?window._ekomiWidgetsServerUrl:window._ekomiServerUrl;var cloudFrontBaseUrl="https://smart-widget-assets.ekomiapps.de/";null!=window._bucket&&(cloudFrontBaseUrl="https://widgets.coddle.de/");var cloudFrontUrl=cloudFrontBaseUrl+"data_files",richSnippetStart='<script id="google-rich-snippet-structured-data" type="application/ld+json">',richSnippetEnd="<\/script>",localBusinessSnippetStart='<script type="application/ld+json">',localBusinessSnippetEnd="<\/script>",blackListTokens=["sf1083005a9426b0e5630","sf1083005a9426c23452c","sf1083005a84045d7445a","sf1083005a84016b3bc54","sf914485a0270efa05f1","sf1082605aa264256efa8","sf68945aba468f73234","sf37558599c3a89c9a73","sf3159259a52ab9d2aae","88954587dc1ce2e3c4","8895457d1574b3870b"],defaultValues={rating:0,empty_review_message:"No Reviews",rating_double:0,rating_floor:0,rating_grade:"",rating_grade_translated:"",filled_stars_computed_width:0,total_reviews_last_year:0,total_reviews:0,rating_percent:0,last_review_text:"",last_review_date:"0000-00-00 00:00:00",last_positive_review_text:"",second_last_positive_review_text:"",last_positive_review_date:"0000-00-00 00:00:00",seal_type:"standard",review_seal_type:"standard",ekomi_certificate_seo:"",positive_reviews_percentage:0,neutral_reviews_percentage:0,negative_reviews_percentage:0,widget_position:"bottom_left",date_format_xxxxx:"",today_date:"",your_company_name:"",review_title:"",review_text_title:"",review_date:"",review_time:"",review_text:"",review_rating:"",review_company_name:"",repeat_filled_stars_computed_width:0,review_pretty_datetime:"",total_positive_reviews:0,total_negative_reviews:0,total_neutral_reviews:0,random_postive_review_text:"",product_name:"",product_image_url:"",product_id:"","5_star_count":0,"5_star_percentage":0,"4_star_count":0,"4_star_percentage":0,"3_star_count":0,"3_star_percentage":0,"2_star_count":0,"2_star_percentage":0,"1_star_count":0,"1_star_percentage":0,rating_sff:0,total_reviews_sff:0,recommended_customers_percentage_sff:0,filled_stars_computed_width_sff:0,"5_star_count_sff":0,"5_star_percentage_sff":0,"4_star_count_sff":0,"4_star_percentage_sff":0,"3_star_count_sff":0,"3_star_percentage_sff":0,"2_star_count_sff":0,"2_star_percentage_sff":0,"1_star_count_sff":0,"1_star_percentage_sff":0,recommended_customers_percentage:0,user_reviews:"",slider_last_10_positive_reviews:"",carousel_slider_reviews:"",rating_group:0,total_reviews_group:0,filled_stars_computed_width_group:0,review_comment_text:"",comment_pretty_datetime:"",widget_social_like:[],widget_social_dislike:[],reviewer_firstname:"",reviewer_lastname:"",seal_type_group:"standard",rating_double_group:0,rating_percent_group:0,last_positive_review_text_group:"",review_images:""};if(0==document.querySelectorAll('[data-ekomi-jquery-not-required="true"]').length&&(void 0===window.jQuery||window.jQuery.fn.jquery<jqueryVersion)){var script_tag=document.createElement("script");script_tag.setAttribute("type","text/javascript"),script_tag.setAttribute("src","https://sw-assets.ekomiapps.de/static_resources/jquery.min.js"),script_tag.readyState?script_tag.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||scriptLoadHandler()}:script_tag.onload=scriptLoadHandler,(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(script_tag)}else window.ekomiWidgetJquery=window.jQuery,main();function arraySearch(e,t){for(var a in e)if(e[a]===t)return a;return!1}function scriptLoadHandler(){if(window.ekomiWidgetJquery=window.jQuery.noConflict(!0),isIE()&&isIE()<=9){var e=document.createElement("script");e.setAttribute("type","text/javascript"),e.setAttribute("src","https://sw-assets.ekomiapps.de/static_resources/jquery.xdomainrequest.min.js"),e.readyState?e.onreadystatechange=function(){"complete"!==this.readyState&&"loaded"!==this.readyState||main()}:main(),(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(e)}else main()}function isSafari(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function isIE(){var e=navigator.userAgent.toLowerCase();return-1!==e.indexOf("msie")&&parseInt(e.split("msie")[1])}function getStringBetween(e,t,a){var i=(e=" "+e).indexOf(t);if(0===i)return"";i+=t.length;var r=e.indexOf(a,i)-i;return e.substr(i,r)}function main(){window.ekomiWidgetJquery(document).ready(function($){var customerId=window._customerId;if(!window.ekomiWidgetJquery('[data-ekomi-global-css-not-required="true"]').length){var css_link=$("<link>",{rel:"stylesheet",type:"text/css",href:"https://sw-assets.ekomiapps.de/static_resources/widget.css"});css_link.appendTo("head")}function isWidgetDeleted(e,t){if(e&&t){if(null!=deletedFileCreatedData[t])return!1;if(null!=deletedFileData[t])return-1!=$.inArray(e,deletedFileData[t]);var a=cloudFrontUrl+"/json/"+t+"_deletedWidgets.json",i=new XMLHttpRequest;i.open("GET",a,!1);var r="noValue";return i.onreadystatechange=function(){if(4===this.readyState)if(404===this.status)r=!1,deletedFileCreatedData[t]=1;else{var a=[];try{a=JSON.parse(this.responseText),deletedFileData[t]=a}catch(e){}r=-1!=$.inArray(e,a)}},i.send(),r}return!0}function getWidgetTokenAndLoad(e){if(oldToken=e,0!=e.indexOf("sf")){var t=cloudFrontUrl+"/mapping/default_mapping.json";void 0!==customerId&&""!==customerId&&(t=cloudFrontUrl+"/mapping/"+customerId+"_mapping.json");var a="",i=new XMLHttpRequest;i.open("GET",t,!0),i.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=JSON.parse(this.responseText)[e],i=window._language;if(void 0!==customerId&&""!==customerId){var r=t.length;if(void 0===i||""===i)a=t[0].new_token,customerId=t[0].customerId;else for(var n=0;n<r;n++)t[n].language===i&&(a=t[n].new_token)}else a=t.new_token,customerId=t.customerId;loadAfterToken(a,customerId,oldToken)}},i.send()}else loadAfterToken(e,customerId,oldToken)}function loadAfterToken(e,t,a){a!=e&&(null==document.getElementsByClassName("ekomi-widget-"+a)[0]?document.getElementById("widget-container").className+=" ekomi-widget-"+e:document.getElementsByClassName("ekomi-widget-"+a)[0].className+=" ekomi-widget-"+e),0!=$.inArray(e,blackListTokens)&&loadWidget(e,t)}function loadWidget(widgetToken,customerId){function getWidgetHtmlFromResponse(e){var t=e.html;return-1!=t.indexOf("google-rich-snippet-structured-data")&&(t=t.replace('<script id="google-rich-snippet-structured-data" type="application/ld+json">{"@context":"http://schema.org/","@type":"Service","aggregateRating":{"@type":"AggregateRating","ratingValue":"*|rating|*","bestRating":"5","reviewCount":"*|total_reviews|*"}}<\/script>',"")),t}function loadAfterWidgetFileLoad(e,t,a){var i=getWidgetHtmlFromResponse(e);appendCss(e.css);var r=e.widget_data;if(null!=r.load_from_widget){var n=document.createElement("script");n.src="https://smart-widget-assets.ekomiapps.de/static_resources/g-widget.js",null!=window._bucket&&(n.src="https://widgets.coddle.de/static_resources/unminified-g-widget.js"),n.onload=function(){loadOldWidget(a,t)},document.head.appendChild(n)}else loadDataInHtml(i,r,t,a)}function loadHtml(e,t){if(null!=tokenFileData[t]&&"loading"!=tokenFileData[t])loadAfterWidgetFileLoad(tokenFileData[t],e,t);else if("loading"==tokenFileData[t])setTimeout(function(){loadHtml(e,t)},1e3);else{var a=cloudFrontUrl+"/widget/"+t+".json";tokenFileData[t]="loading";var i=new XMLHttpRequest;i.open("GET",a,!0),i.onreadystatechange=function(){if(4===this.readyState){if(404===this.status){if(widgetFileCount[t]>=maxCallCount)return;if(widgetFileCount[t]=widgetFileCount[t]+1,0!=isWidgetDeleted(t,customerId))return;updateWidgetFile(t,customerId)}if(200===this.status){var a=JSON.parse(this.responseText);tokenFileData[t]=a,loadAfterWidgetFileLoad(a,e,t)}}},i.send()}}function appendCss(e){var t=e,a=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");a.appendChild(i),i.type="text/css",i.className="eKomi-widget-css",i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}function updateWidgetFile(e,t){if(e&&t){var a=smartWidgetsServercloudFrontUrl+"/update-widget-file/"+e+"?customerId="+t,i=new XMLHttpRequest;i.open("GET",a,!1),i.onreadystatechange=function(){4===this.readyState&&200===this.status&&setTimeout(function(){loadHtml(productID,e)},defaultRetryTime)},i.send()}}function replaceDefaultValues(e,t,a){var i=!1;for(var r in defaultValues)if(defaultValues.hasOwnProperty(r)){var n=new RegExp("\\*\\|"+r+"\\|\\*","g");t!=(t=t.replace(n,defaultValues[r]))&&(i=!0)}i&&!a&&createJsonFile();n=new RegExp("\\*\\|comment_text\\|\\*","g");t=t.replace(n,'<com class="comment_div_hidden"></com>');var s=new RegExp("\\*\\|(.*?)\\|\\*","g");t=t.replace(s,"");var l=$("#widget-container");$(".ekomi-widget-"+widgetToken+".div_"+a).length?l=$(".ekomi-widget-"+widgetToken+".div_"+a):$(".ekomi-widget-"+e).length&&(l=$(".ekomi-widget-"+e)),l.html(t),l.find(".comment_div_hidden").each(function(){ekomiWidgetJquery(this).parents("comment_repeat").remove()}),(tokenFileData[e].widget_data.is_lp||tokenFileData[e].widget_data.is_cp)&&createFiltersForLandingPage(l,e)}function addRatingFilterDropDownForLandingPage(e,t){for(var a=1;a<=5;a++){var i=e.find("filterisstar_"+a).html();e.find("filterisstar_"+a).before('<a href="javascript:" data-filter-type="filterisstar" data-filter="'+a+'" class="ratingFilterLP LP_filters ekomi_widget_filter_star">'+i+"</a>"),e.find("filterisstar_"+a).remove()}$(".ratingFilterLP").click(function(){currentPageInPagination=1,e.find(".LP_filters").removeClass("ekomi-star-filter-active"),$(this).addClass("ekomi-star-filter-active");var a=$(this).data("filter");getMoreReviewsLandingPage(0,t,e,null,null,a)})}function addReviewsFilterForLandingPage(e,t){var a=tokenFileData[t].widget_data.lp_translations;e.find(".reviews").before('<div class="filter-content"><div class="filter-heading"><span class="title-section-inner">'+a["evaluation and review"]+'</span></div><div class="controls"><ul><li class="sort chronological_filter active LP_filters" data-filter-type="filterischronological" data-sort-direction="desc"><span>'+a["newest first"]+'</span></li><li class="sort chronological_filter LP_filters" data-filter-type="filterischronological" data-sort-direction="asc"><span>'+a["oldest first"]+'</span></li><li class="sort rating_filter LP_filters" data-filter-type="filterisrating" data-sort-rating-direction="desc"> <span>'+a["in descending order of evaluation"]+'</span></li><li class="sort rating_filter LP_filters" data-filter-type="filterisrating" data-sort-rating-direction="asc"><span>'+a["in ascending order of evaluation"]+"</span></li></ul></div></div>"),$(document).on("click",".chronological_filter",function(){currentPageInPagination=1,e.find(".LP_filters").removeClass("ekomi-star-filter-active"),$(this).addClass("ekomi-star-filter-active"),e.find(".LP_filters").removeClass("active"),$(this).addClass("active");var a=$(this).data("sort-direction");getMoreReviewsLandingPage(0,t,e,a,null,null)}),$(document).on("click",".rating_filter",function(){currentPageInPagination=1,e.find(".LP_filters").removeClass("ekomi-star-filter-active"),$(this).addClass("ekomi-star-filter-active"),e.find(".LP_filters").removeClass("active"),$(this).addClass("active");var a=$(this).data("sort-rating-direction");getMoreReviewsLandingPage(0,t,e,null,a,null)})}function setPagination(){document.querySelector("ul.pagination").id="paginator";var e=document.querySelectorAll("#paginator li"),t=[];for(let a=0;a<e.length;a++)e[a].classList.contains("active")?(t[a]=!1,null!=e[a].nextSibling&&(t[a+a]=!1),null!=e[a].previousSibling&&(t[a+a]=!1)):null!=e[a].nextSibling&&e[a].nextSibling.classList.contains("active")?t[a]=!1:null!=e[a].previousSibling&&e[a].previousSibling.classList.contains("active")?t[a]=!1:t[a]=!0;for(let a=0;a<e.length;a++)t[a]&&e[a].remove()}function makePaginateLinks(e,t,a,i,r,n,s,l,o){var d="";s?(console.log("reverse case entered"),totalPageLinks=1==l?1*o+5:totalPageLinks,isForward&&(console.log("reverse-isForward case entered"),totalPageLinks=0==l?totalPageLinks-lastDifferenceFactor+1:totalPageLinks,currentMaxToSkip=currentMaxToSkip-lastDifferenceFactor*n+n),(totalPageLinks=totalPageLinks<=a?a+1:totalPageLinks)>t&&(console.log("reverse-totalpagelinks greater case entered"),totalPageLinks=t+1),r>t&&(console.log("reverse-maxcount greater case entered"),r=t)):(console.log("forward case entered"),console.log(5),totalPageLinks=1==l&&r>=a?o-5:totalPageLinks,1==l&&(console.log("forward-onestep case entered"),r>=a?(console.log("forward-onestep maxcount greater case entered"),totalPageLinks=o-5):(console.log("forward-onestep maxcount less than case entered"),totalPageLinks=o-1)),isForward||(console.log("forward- !isForward case entered case entered"),totalPageLinks=0==l?totalPageLinks+lastDifferenceFactor-1:totalPageLinks,currentMaxToSkip=currentMaxToSkip+lastDifferenceFactor*n-n),console.log(t),console.log(a),totalPageLinks+r>t&&(console.log("forward-total page links + maxcount greater case entered"),t>a?(console.log("forward-total page links + maxcount- totalpages greater case entered"),r=a):(console.log("forward-total page links + maxcount- totalpages greater case entered"),r=t-totalPageLinks),totalPageLinks=t-r),t<=a&&(console.log("forward- NEW case entered !!!!!!!!!!!!!!!!!!!!!!!!!!"),totalPageLinks=0,currentMaxToSkip=0,r=t));for(var c=1;c<=r;c++){var p="";s?(totalPageLinks--,l&&totalPageLinks==o&&(p="active"),d='<li class="'+p+'"><a href="javascript:" class="page_link" data-page-link="'+totalPageLinks+'" data-skip="'+(currentMaxToSkip=(totalPageLinks-1)*n)+'">'+totalPageLinks+"</a></li>"+d):(totalPageLinks++,l&&totalPageLinks==o&&(p="active"),d+='<li class="'+p+'"><a href="javascript:" class="page_link" data-page-link="'+totalPageLinks+'" data-skip="'+(currentMaxToSkip=(totalPageLinks-1)*n)+'">'+totalPageLinks+"</a></li>")}return isForward=!s,lastDifferenceFactor=r,$(document).off("click",".page_link").on("click",".page_link",function(){var t=$(this).data("skip");currentPageInPagination=$(this).data("page-link");var a=null,r=null,n=null;ekomiWidgetJquery(".rating_filter.ekomi-star-filter-active").length&&(a=ekomiWidgetJquery(".rating_filter.ekomi-star-filter-active").data("sort-rating-direction")),ekomiWidgetJquery(".chronological_filter.ekomi-star-filter-active").length&&(r=ekomiWidgetJquery(".chronological_filter.ekomi-star-filter-active").data("sort-direction")),ekomiWidgetJquery(".ratingFilterLP.ekomi-star-filter-active").length&&(n=ekomiWidgetJquery(".ratingFilterLP.ekomi-star-filter-active").data("filter")),getMoreReviewsLandingPage(t,i,e,r,a,n)}),$(document).off("click",".page_link_dots_forward").on("click",".page_link_dots_forward",function(e){e.stopPropagation(),e.preventDefault(),$(".btm-pagination.nav-pagination nav ul li.active").next().find(".page_link").trigger("click")}),$(document).off("click",".page_link_dots_backward").on("click",".page_link_dots_backward",function(){$(".btm-pagination.nav-pagination nav ul li.active").prev().find(".page_link").trigger("click")}),$(document).off("click",".page_link_dots_full_forward").on("click",".page_link_dots_full_forward",function(){var t=summaryFileData[cloudFrontUrl+"/json/"+customerId+"_seller_summary.json"].total_reviews,r=tokenFileData[i].html.match(/<repeat_[^>]+>/i)[0].match(/\d+/)[0],n=Math.ceil(t/r);currentMaxToSkip=(n-a)*r,totalPageLinks=n-a+1,isForward=!1;var s=makePaginateLinks(e,n,a,i,n<=a?n:a,r,!1,!1);$(".nav-pagination ul.pagination").html(s),$(".nav-pagination ul.pagination li:last-child").find(".page_link").trigger("click")}),d}function createPaginateLinks(e,t,a){ekomiWidgetJquery(".nav-pagination").remove();var i=tokenFileData[a].widget_data.lp_translations,r=tokenFileData[a].html,n=r.match(/<repeat_[^>]+>/i)[0].match(/\d+/)[0],s=Math.ceil(e/n);lastDifferenceFactor=9;var l=i["full backward arrow"],o=i.previous,d=i.next,c=(i["single forward arrow"],i["single backward arrow"],i["full forward arrow"]),p=!1;-1!==r.indexOf("full_first_last_links")&&currentPageInPagination>1&&(p=!0);var g=s<=9?s:9,u=makePaginateLinks(t,s,9,a,g,n,!0,!0,currentPageInPagination),_="",f='<li class="previous" style="display:none;"><a href="javascript:" class="previous page_link_dots_full_backward" style="display:none;">'+l+"</a></li>";p&&(f='<li class="previous"><a href="javascript:" class="previous page_link_dots_full_backward">'+l+"</a></li>");var m='<div class="col-md-3 col-xs-3"><ul class="pre-next">'+f+'<li class="previous"><a href="javascript:" class="previous page_link_dots_backward" style="display:none;">'+o+"</a></li></ul></div>";if(g>1){var v='<li class="next"><a href="javascript:" class="next page_link_dots_full_forward" style="display:none;">'+c+"</a></li>";p&&(v='<li class="next"><a href="javascript:" class="next page_link_dots_full_forward">'+c+"</a></li>"),_='<div class="col-md-3 col-xs-3"><ul class="pre-next"><li class="next"><a href="javascript:" class="next page_link_dots_forward">'+d+"</a></li>"+v+"</ul></div>"}$(".reviews").after('<div class="btm-pagination text-center nav-pagination clearfix">'+m+'<div class="col-md-6 col-xs-6"><nav aria-label="Page navigation"><ul class="pagination">'+u+"</ul></nav></div>"+_+"</div>"),currentPageInPagination>1?$(".page_link_dots_backward").show():$(".page_link_dots_backward").hide(),currentPageInPagination==s?$(".page_link_dots_forward").hide():$(".page_link_dots_forward").show(),void 0!==tokenFileData[a].widget_data&&void 0!==tokenFileData[a].widget_data.is_cp&&tokenFileData[a].widget_data.is_cp&&setPagination()}function createFiltersForLandingPage(e,t){addReviewsFilterForLandingPage(e,t),addRatingFilterDropDownForLandingPage(e,t),createPaginateLinks(summaryFileData[cloudFrontUrl+"/json/"+customerId+"_seller_summary.json"].total_reviews,e,t),$(document).find(".nav-pagination").before('<div id="spinner" class="spinner" style="display: none;"><img class="img-spinner" src="'+smartWidgetsServerBaseUrl+'/resources/images/default.svg" alt="Loading"></div>')}function getMoreReviewsLandingPage(e,t,a,i,r,n){var s=smartWidgetsServerBaseUrl+"/get-more-reviews",l=tokenFileData[t].html,o=l.match(/<repeat_[^>]+>/i),d=o[0].match(/\d+/)[0],c=o[0].match(/(?:_[a-zA-Z]+)*_/i)[0].replace(/_/g,""),p=tokenFileData[t].widget_data;$("#spinner").show(),$.get({url:s,cache:!0,data:{widgetToken:t,crossDomain:!0,dataType:"jsonp",lastShown:e,required:d,sortDirection:i,orderByRating:r,filterRating:n,returnTotal:!0}},function(e){var i=o[0],r="</repeat";c&&"random"!=c&&(r+="_"+c),d&&(r+="_"+d),r+=">",-1==l.indexOf(r)&&(r="</repeat>");for(var n=getStringBetween(tokenFileData[t].html,i,r),s=getDateFormat(n),g="",u=e.length>0?e[0].total_reviews:0,_=0;_<d&&_<e.length;_++){var f=e[_],m=n;for(var v in f){if("review_rating"==v||"rating"==v)m=replaceRepeatFilledStarComputedWidth(p,f[v],m),m=replaceReviewPlaceholders(f[v],m,p),x=new RegExp("\\*\\|rating\\|\\*","g"),m=m.replace(x,f[v]),x=new RegExp("\\*\\|review_rating\\|\\*","g"),m=m.replace(x,f[v]);else if("review_date"==v){var w=new Date(f[v]);f[v]=getDate(s,w);var h=w.getHours()+":"+(w.getMinutes()<10?"0"+w.getMinutes():w.getMinutes()),k=new RegExp("\\*\\|review_time\\|\\*","g");m=m.replace(k,h);var y=new RegExp("\\*\\|review_date_only\\|\\*","g");m=m.replace(y,getDate(getDateFormat(l),w))}var x=new RegExp("\\*\\|"+v+"\\|\\*","g");m=m.replace(x,f[v])}g+=m}""==g&&(g="*|empty_review_message|*");x=new RegExp("\\*\\|comment_text\\|\\*","g");g=g.replace(x,'<com class="comment_div_hidden"></com>');var S=new RegExp("\\*\\|(.*?)\\|\\*","g");g=g.replace(S,""),$(".reviews").html(g),$(".reviews").find(".comment_div_hidden").each(function(){ekomiWidgetJquery(this).parents("comment_repeat").remove()}),createPaginateLinks(u,a,t),$("#spinner").hide()})}function createJsonFile(){}function getSealImageHeight(e){return e<41?33:e<46?41:e<56?46:e<66?56:e<72?66:e<74?72:e<81?74:e<90?81:e<105?90:e<150?105:e<232?150:e<500?232:500}function loadDataAfterSummaryLoad(e,t,a,i,r,n,s){var l=!1;if((null!=r.is_rich||null!=r.is_rich_with_reviews||null!=r.is_local_business)&&null!=e&&e.total_reviews>0){var o=i;if(null!=schemaData[customerId]&&null!=schemaData[customerId][o])void 0!==r.is_rich_with_reviews?a+=richSnippetStart+schemaData[customerId][o].rich_snippet_with_reviews+richSnippetEnd:void 0!==r.is_rich&&(a+=richSnippetStart+schemaData[customerId][o].rich_snippet+richSnippetEnd),void 0!==r.is_local_business&&(a+=richSnippetStart+schemaData[customerId][o].local_business+richSnippetEnd);else{l=!0;var d=cloudFrontUrl+"/json/"+customerId+"_schema.json";null!=r.lite_service&&(d=cloudFrontUrl+"/json/"+customerId+"_"+r.lite_service+"_schema.json"),$(".data-ekomi-emp").length&&i&&(d=cloudFrontUrl+"/product/"+customerId+"/"+s+"/schema.json");var c=new XMLHttpRequest;c.open("GET",d,!0),c.onreadystatechange=function(){if(4===this.readyState){if(this.status,200==this.status){var l=JSON.parse(this.responseText);if(null!=l){if(null==schemaData[customerId]&&(schemaData[customerId]=[]),null!=window._schema_fields){var d=window._schema_fields;if(null!=l.rich_snippet){var c=JSON.parse(l.rich_snippet);for(var p in d)d.hasOwnProperty(p)&&(c[p]=d[p]);l.rich_snippet=JSON.stringify(c)}if(null!=l.rich_snippet_with_reviews){var g=JSON.parse(l.rich_snippet_with_reviews);for(var p in d)d.hasOwnProperty(p)&&(g[p]=d[p]);l.rich_snippet_with_reviews=JSON.stringify(g)}}if(schemaData[customerId][o]=l,void 0!==r.is_rich&&void 0!==r.is_local_business&&null!=l.rich_snippet)try{var u=JSON.parse(l.local_business),_=JSON.parse(l.rich_snippet);u.aggregateRating=_.aggregateRating,a+=localBusinessSnippetStart+JSON.stringify(u)+localBusinessSnippetEnd}catch(e){void 0!==r.is_rich_with_reviews&&null!=l.rich_snippet_with_reviews?a+=richSnippetStart+l.rich_snippet_with_reviews+richSnippetEnd:void 0!==r.is_rich&&null!=l.rich_snippet&&(a+=richSnippetStart+l.rich_snippet+richSnippetEnd),void 0!==r.is_local_business&&(a+=localBusinessSnippetStart+l.local_business+localBusinessSnippetEnd)}else if(void 0!==r.is_rich_with_reviews&&void 0!==r.is_local_business&&null!=l.rich_snippet_with_reviews)try{u=JSON.parse(l.local_business);var f=JSON.parse(l.rich_snippet_with_reviews);u.aggregateRating=f.aggregateRating,u.review=f.review,a+=localBusinessSnippetStart+JSON.stringify(u)+localBusinessSnippetEnd}catch(e){void 0!==r.is_rich_with_reviews&&null!=l.rich_snippet_with_reviews?a+=richSnippetStart+l.rich_snippet_with_reviews+richSnippetEnd:void 0!==r.is_rich&&null!=l.rich_snippet&&(a+=richSnippetStart+l.rich_snippet+richSnippetEnd),void 0!==r.is_local_business&&(a+=localBusinessSnippetStart+l.local_business+localBusinessSnippetEnd)}else void 0!==r.is_rich_with_reviews&&null!=l.rich_snippet_with_reviews?a+=richSnippetStart+l.rich_snippet_with_reviews+richSnippetEnd:void 0!==r.is_rich&&null!=l.rich_snippet&&(a+=richSnippetStart+l.rich_snippet+richSnippetEnd),void 0!==r.is_local_business&&(a+=localBusinessSnippetStart+l.local_business+localBusinessSnippetEnd)}}null==e&&replaceDefaultValues(t,a,i),replacePlaceholders(t,e,r,a,n,i,s)}},c.send()}}null!=r.enable_google_tracking&&(a+=getGoogleAnalyticsCode(t)),l||(null==e&&replaceDefaultValues(t,a,i),replacePlaceholders(t,e,r,a,n,i,s)),r.qa_enable&&replaceQaSection(widgetToken,i)}function getGoogleAnalyticsCode(e){return"<script async src=\"https://www.googletagmanager.com/gtag/js?id=UA-161255322-8\"><\/script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'UA-161255322-8');gtag('event', 'event_widget_hits', {'event_category' : 'category_widget_hits','event_label' : '"+e+"','value': 1});<\/script>"}function replaceQaSection(e,t){var a=smartWidgetsServerBaseUrl+"/get-question-answer";a=a+"?widget_token="+e+"&product_id="+t;var i=new XMLHttpRequest;new FormData;i.open("GET",a,!0),i.onreadystatechange=function(){if(4==i.readyState&&200==i.status){var e=i.response;$("#widget-container").append(e)}},i.send()}function replaceSealIfRequired(e,t,a){if(null!=e&&null!=e.enableSeal){var i=$("#widget-container");if($(".ekomi-widget-"+a+".div_"+t).length?i=$(".ekomi-widget-"+a+".div_"+t):$(".ekomi-widget-"+a).length&&(i=$(".ekomi-widget-"+a)),null!=e.doHideWidget&&e.doHideWidget)i.hide();else{var r=0;i.children().each(function(){r+=ekomiWidgetJquery(this).outerHeight(!0)});var n=getSealImageHeight(r),s='<img src="'+cloudFrontBaseUrl+"resources/en_seal_standard-"+n+'.png">';i.html(s)}}}function loadAfterProductIdLoaded(e,t,a,i,r,n,s){if(null!=summaryFileData[e]&&"loading"!=summaryFileData[e]){var l=summaryFileData[e];-1!=e.indexOf("combined_summary")&&(l=summaryFileData[e][s]),loadDataAfterSummaryLoad(l,r,t,i,a,n,s)}else if("loading"==summaryFileData[e])setTimeout(function(){loadAfterProductIdLoaded(e,t,a,i,r,n,s)},1e3);else{summaryFileData[e]="loading";var o=new XMLHttpRequest;o.open("GET",e,!0),o.onreadystatechange=function(){if(4===this.readyState&&(404===this.status&&replaceDefaultValues(r,t,i),200===this.status)){var l=JSON.parse(this.responseText);summaryFileData[e]=l,-1!=e.indexOf("combined_summary")&&(l=l[s]),loadDataAfterSummaryLoad(l,r,t,i,a,n,s)}},o.send()}}function createUpdateProductIdFile(e,t){var a=smartWidgetsServercloudFrontUrl+"/create-product-file",i=new XMLHttpRequest,r=new FormData;r.append("shop_id",t),r.append("product_id",e),i.open("POST",a,!0),i.send(r)}function loadProductIdsJson(e,t,a,i){var r=cloudFrontUrl+"/product/"+customerId+"/productIds.json";if(null!=productIdsFileData[customerId]){var n=arraySearch(productIdsFileData[customerId],a);if(0==n)createUpdateProductIdFile(a,customerId),replaceDefaultValues(i,e,a);else{var s=n;null!=t.load_combined_summary&&$(".ekomi-widget-"+i).length>1?jsonLink=cloudFrontUrl+"/product/"+customerId+"/combined_summary.json":jsonLink=cloudFrontUrl+"/product/"+customerId+"/"+s+"/summary.json",loadAfterProductIdLoaded(jsonLink,e,t,a,i,!1,s)}}else{var l=new XMLHttpRequest;l.open("GET",r,!0);l.onreadystatechange=function(){if(4===this.readyState&&(404===this.status&&null,200===this.status)){var r="";try{r=JSON.parse(this.responseText),productIdsFileData[customerId]=r}catch(e){}var n=arraySearch(r,a);if(0==n)createUpdateProductIdFile(a,customerId),replaceDefaultValues(i,e,a);else{var s=n;null!=t.load_combined_summary&&$(".ekomi-widget-"+i).length>1?jsonLink=cloudFrontUrl+"/product/"+customerId+"/combined_summary.json":jsonLink=cloudFrontUrl+"/product/"+customerId+"/"+s+"/summary.json",loadAfterProductIdLoaded(jsonLink,e,t,a,i,!1,s)}}},l.send()}}function loadDataInHtml(e,t,a,i){var r=cloudFrontUrl+"/json/"+customerId+"_seller_summary.json";if(null!=t.lite_service&&(r=cloudFrontUrl+"/json/"+customerId+"_"+t.lite_service+"_summary.json"),null!=t.group_shops_hash)loadAfterProductIdLoaded(r=cloudFrontUrl+"/group/"+t.group_shops_hash+"_summary.json",e,t,a,i,!0,null);else if($(".data-ekomi-emp").length&&a){if(-1==a.indexOf(","))return loadProductIdsJson(e,t,a,i);var n=new XMLHttpRequest,s=new FormData;s.append("pid",a),n.open("POST",smartWidgetsServerBaseUrl+"/cnv.php",!0),n.onload=function(){var a=JSON.parse(this.responseText);loadProductIdsJson(e,t,a.join(","),i)},n.onerror=function(){multipleProducts=a.split(",").sort().sort(function(e,t){return e>t}),a=multipleProducts.join(","),loadProductIdsJson(e,t,a,i)},n.send(s)}else!$(".data-ekomi-emp").length&&a||loadAfterProductIdLoaded(r,e,t,a,i,!1,null)}function replaceRepeatTag(e,t,a,i,r,n,s,l){var o=n[0].match(/(?:_[a-zA-Z]+)*_/i)[0].replace(/_/g,""),d=n[0].match(/\d+/)[0],c=n[0],p=new XMLHttpRequest;""==o&&(o="random");var g="";g=null!=a.group_shops_hash?cloudFrontUrl+"/group/"+a.group_shops_hash+"_"+o+"_1.json":i?cloudFrontUrl+"/product/"+customerId+"/"+r+"/"+o+"_1.json":null!=a.lite_service?cloudFrontUrl+"/json/"+customerId+"_"+a.lite_service+"_"+o+"_1.json":cloudFrontUrl+"/json/"+customerId+"_"+o+"_1.json",p.open("GET",g,!0),p.onreadystatechange=function(){if(4===this.readyState){if(404===this.status){if(replaceDefaultValues(l,t,i),replaceSealIfRequired(e,i,l),i)return null;createJsonFile()}if(200===this.status)try{var r=JSON.parse(this.responseText);if(null==r)return t;var n="",p="</repeat";o&&"random"!=o&&(p+="_"+o),d&&(p+="_"+d),p+=">",-1==t.indexOf(p)&&(p="</repeat>");for(var g=getStringBetween(t,c,p),u=getDateFormat(g),_=0;_<d&&_<r.length;_++){var f=r[_],m=g;for(var v in f){if("review_rating"==v)m=replaceRepeatFilledStarComputedWidth(a,f[v],m),m=replaceReviewPlaceholders(f[v],m,a);else if("review_date"==v){if(isNumber(f[v]))var w=new Date(1e3*f[v]);else if(isSafari()){var h=formattedDate(f[v]).split("-").join("/");w=new Date(h)}else w=new Date(formattedDate(f[v]));f[v]=getDate(u,w);var k=w.getHours()+":"+(w.getMinutes()<10?"0"+w.getMinutes():w.getMinutes()),y=new RegExp("\\*\\|review_time\\|\\*","g");m=m.replace(y,k);var x=new RegExp("\\*\\|review_date_only\\|\\*","g");m=m.replace(x,getDate(getDateFormat(t),w))}var S=new RegExp("\\*\\|"+v+"\\|\\*","g");m=m.replace(S,f[v])}n+=m}""==n&&(n="*|empty_review_message|*");var F=c+g+p;t=t.replace(F,n),replaceData(e,t,a,s,l),replaceSealIfRequired(e,i,l)}catch(e){}}},p.send()}function isNumber(e){return/^-?[\d.]+(?:e-?\d+)?$/.test(e)}function formattedDate(e){var t=" ";-1!=e.indexOf("/")?t="/":-1!=e.indexOf(".")?t=".":-1!=e.indexOf("-")&&(t="-");var a=e.split(t),i=a[0],r=a[1];return a[2].split(" ")[0].trim()+"-"+r+"-"+i+" "+a[2].split(" ")[1].split(":")[0].trim()+":"+a[2].split(" ")[1].split(":")[1].trim()}function getDate(e,t){var a="";if(-1!=e.indexOf("n")&&-1!=e.indexOf("j")&&-1!=e.indexOf("Y"))return a=(a=(a=e.replace("Y",t.getFullYear())).replace("n",t.getMonth()+1)).replace("j",t.getDate());var i=" ";-1!=e.indexOf("/")?i="/":-1!=e.indexOf(".")?i=".":-1!=e.indexOf("-")&&(i="-");for(var r=e.split(i),n=r.length,s=0;s<n;s++)-1!=r[s].indexOf("d")||-1!=r[s].indexOf("D")?a+=""==a?t.getDate()>9?t.getDate():"0"+t.getDate():i+(t.getDate()>9?t.getDate():"0"+t.getDate()):-1!=r[s].indexOf("m")||-1!=r[s].indexOf("M")?a+=""==a?t.getMonth()>8?t.getMonth()+1:"0"+(t.getMonth()+1):i+(t.getMonth()>8?t.getMonth()+1:"0"+(t.getMonth()+1)):-1==r[s].indexOf("y")&&-1==r[s].indexOf("Y")||(a+=""==a?t.getFullYear():i+t.getFullYear());return a}function replaceTodayDate(e){if(-1==e.indexOf("*|today_date|*"))return e;var t=getDate(getDateFormat(e),new Date),a=new RegExp("\\*\\|today_date\\|\\*","g");return e.replace(a,t)}function getSealType(e,t){var a="standard";if(ratingRange(t,4.8,5.1)&&e>=50)a="gold";else if(ratingRange(t,4.45,4.8)&&e>=50)a="silver";else if(ratingRange(t,4,4.45)&&e>=50)a="bronze";else if(ratingRange(t,4,5.1)&&e<50)a="neutral";else if(ratingRange(t,0,4.1)&&e<50)return a;return a}function ratingRange(e,t,a){return e>=t&&e<a}function replaceEmptyWidgetMessage(e,t){var a=new RegExp("\\*\\|empty_review_message\\|\\*","g");return"empty_review_message"in e||(e.empty_review_message=defaultValues.empty_review_message),t.replace(a,e.empty_review_message)}function replaceSeal(e,t,a){var i=new RegExp("\\*\\|seal_type\\|\\*","g"),r=new RegExp("\\*\\|seal_type_group\\|\\*","g"),n=getSealType(e,t);return(a=a.replace(r,n)).replace(i,n)}function getRatingGrade(e,t){var a="";return ratingRange(t,4.8,5.1)&&e>=50?a="excellent":ratingRange(t,4.45,4.8)&&e>=50?a="excellent":ratingRange(t,4,4.45)&&e>=50?a="good":ratingRange(t,4,5.1)&&e<50?(a="good",ratingRange(t,4.45,5.1)&&(a="excellent")):ratingRange(t,0,4.1)&&e<50&&(a=""),a}function replaceRatingGrade(e,t,a,i){var r=new RegExp("\\*\\|rating_grade\\|\\*","g"),n=new RegExp("\\*\\|rating_grade_translated\\|\\*","g"),s=getRatingGrade(t,a),l=e.rating_grade_translated[s];return""==s&&(l=""),(i=i.replace(n,l)).replace(r,s)}function replaceFilledStarComputedWidth(widgetData,rating,widgetHtml){var regexTranslated=new RegExp("\\*\\|filled_stars_computed_width\\|\\*","g"),regexFilledStarGroup=new RegExp("\\*\\|filled_stars_computed_width_group\\|\\*","g"),formula=widgetData.filled_stars_computed_formula;if(formula){var filled_stars_computed_width=formula.replace("*|rating|*",rating).replace("*|rating_floor|*",Math.floor(rating));return filled_stars_computed_width=eval(filled_stars_computed_width),widgetHtml=widgetHtml.replace(regexTranslated,filled_stars_computed_width),widgetHtml.replace(regexFilledStarGroup,filled_stars_computed_width)}return widgetHtml}function replaceRepeatFilledStarComputedWidth(widgetData,rating,widgetHtml){var regexTranslated=new RegExp("\\*\\|repeat_filled_stars_computed_width\\|\\*","g"),formula=widgetData.repeat_filled_stars_computed_formula;if(formula){var filled_stars_computed_width=formula.replace("*|rating|*",rating).replace("*|rating_floor|*",Math.floor(rating));return filled_stars_computed_width=eval(filled_stars_computed_width),widgetHtml.replace(regexTranslated,filled_stars_computed_width)}return widgetHtml}function replaceReviewPlaceholders(e,t,a){var i=new RegExp("\\*\\|review_rating_grade\\|\\*","g"),r=new RegExp("\\*\\|review_seal_type\\|\\*","g"),n=getRatingGrade(0,e),s=getSealForReview(e),l=a.rating_grade_translated[n];return""==n&&(l=""),t=(t=t.replace(i,l)).replace(r,s)}function getSealForReview(e){var t="standard";if(ratingRange(e,4.8,5.1))t="gold";else if(ratingRange(e,4.45,4.8))t="silver";else{if(!ratingRange(e,4,4.45))return t;t="bronze"}return t}function replaceRatingPlaceholders(e,t){var a=new RegExp("\\*\\|rating_double\\|\\*","g"),i=new RegExp("\\*\\|rating_floor\\|\\*","g"),r=new RegExp("\\*\\|rating_percent\\|\\*","g"),n=new RegExp("\\*\\|rating_group\\|\\*","g"),s=new RegExp("\\*\\|rating_double_group\\|\\*","g"),l=new RegExp("\\*\\|rating_percent_group\\|\\*","g");return(t=(t=(t=(t=(t=t.replace(i,Math.floor(e))).replace(r,Math.round(e/5*100))).replace(n,e)).replace(s,2*e)).replace(l,Math.round(e/5*100))).replace(a,2*e)}function replaceSpecificPlaceholders(e,t,a,i){var r=null!=e&&null!=e.total_reviews?e.total_reviews:0;if(i){if(null!=e&&null!=e.rating_group)s=e.rating_group;else if(null!=e&&null!=e.rating)s=e.rating;if(null!=s){a=replaceFilledStarComputedWidth(t,s,a=replaceRatingPlaceholders(s,a=replaceRatingGrade(t,r,s,a=replaceSeal(r,s,a=replaceEmptyWidgetMessage(t,a)))));var n=new RegExp("\\*\\|ekomi_certificate_seo\\|\\*","g");a=a.replace(n,t.ekomi_certificate_seo)}}else{var s;if(null!=e&&null!=e.rating&&null!=r)a=replaceFilledStarComputedWidth(t,s=null!=e.rating?e.rating:0,a=replaceRatingPlaceholders(s,a=replaceRatingGrade(t,r,s,a=replaceSeal(r,s,a=replaceEmptyWidgetMessage(t,a)))))}return a}function replaceData(e,t,a,i,r){for(var n in e)if(e.hasOwnProperty(n)){var s=new RegExp("\\*\\|"+n+"\\|\\*","g");void 0!==n[0]&&"<"==n[0]&&(s=new RegExp(n,"g")),t=t.replace(s,e[n])}replaceDataTimePlaceholdersAndInsertInContainer(r,t=replaceSpecificPlaceholders(e,a,t,i),productID)}function replacePlaceholders(e,t,a,i,r,n,s){var l=(i=replaceTodayDate(i)).match(/<repeat_[^>]+>/i);null!=l&&void 0!==l[0]?replaceRepeatTag(t,i,a,n,s,l,r,e):(replaceData(t,i,a,r,e),replaceSealIfRequired(t,n,e))}function getDateFormat(e){var t="",a=e.indexOf("*|date_format_"),i=e.indexOf("|*",a);if(a>0){for(z=a+14;z<i;z++)t+=e[z];"xxxxx"===t&&(t="d.M.yyyy")}else t="d.M.yyyy";return t}function replaceDataTimePlaceholdersAndInsertInContainer(e,t,a){var i=getDateFormat(t);if((t=t.replace("*|date_format_"+i+"|*","")).indexOf("SimpleScrollbar.initEl")>0){var r=document.createElement("script");r.src="https://sw-assets.ekomiapps.de/static_resources/simple-scrollbar.min.js",r.type="text/javascript",r.onload=function(){replaceDefaultValues(e,t,a)},document.getElementsByTagName("head")[0].appendChild(r)}else if($(".data-ekomi-emp").length&&a){for(var n=a.split(",").sort(),s="",l=0;l<n.length;l++){s+=".div_"+n[l].replace(/\./g,"-_dot_-").split("%").join("-_perc_-").split("/").join("-_slash_-").replace(/\s+/g,"-_-_").replace("+","plus")}$(s+".ekomi-widget-"+e).html(t).removeClass("data-ekomi-emp"),replaceDefaultValues(e,t,a)}else replaceDefaultValues(e,t,a);var o=$("#widget-container");$(".ekomi-widget-"+e).length&&(o=$(".ekomi-widget-"+e)),o.find(".ekomi-slick-slider").length&&(window.jq=$,$.getScript("https://sw-assets.ekomiapps.de/static_resources/slick.js",function(){$(".ekomi-slick-slider").each(function(){$(this).not(".slick-initialized").slick()})}))}widgetFileCount[widgetToken]=0;var productID="";if("ekomi-product-widget-identifier"==$(".ekomi-widget-"+widgetToken).next().attr("id")){var prodIdentifier=$("#ekomi-product-widget-identifier");$(".prod-data-emp").length&&(prodIdentifier=$(".ekomi-widget-"+widgetToken).next(".prod-data-emp").first(),prodIdentifier.removeClass("prod-data-emp")),productID=prodIdentifier.text();var dataContainer=prodIdentifier.prev(),multipleProducts=productID.split(",").sort();productID=multipleProducts.join(","),$.each(multipleProducts,function(e,t){dataContainer.addClass("div_"+t.trim().replace(/\./g,"-_dot_-").split("%").join("-_perc_-").split("/").join("-_slash_-").replace(/\s+/g,"-_-_").replace("+","plus").replace("(","brkt").replace(")","brkt").replace("{","brkt").replace("}","brkt").replace("[","brkt").replace("]","brkt").split(":").join("-coln-"))}),productID.trim()||(productID="")}loadHtml(productID,widgetToken)}void 0!==window._ekomiToken&&getWidgetTokenAndLoad(window._ekomiToken),$.each(window._ekomiWidgetTokens,function(e,t){getWidgetTokenAndLoad(t)}),window.ekomiWidgetJquery(document).on("click",".translate_text_btn",function(e){if(e.preventDefault(),$(this).is("[disabled=disabled]"))return!1;var t=$(this),a=$(this).parents(".text_translate_parent").find(".text_translate");0!==$(this).parents(".text_translate_parent").find(".trans_after").length?a.each(function(){var e=$.grep(this.className.split(" "),function(e){return 0===e.indexOf("text_translate_")}).join(),t=$("."+e).html(),a=e.split("_")[2],i=$(this).parents(".text_translate_parent").find(".trans_after_"+a).text();if(t.trim()===i){var r=$(this).parents(".text_translate_parent").find(".trans_before_"+a).text();$(this).parents(".text_translate_parent").find(".text_translate_"+a).html(r)}else $(this).parents(".text_translate_parent").find(".text_translate_"+a).html(i)}):a.each(function(){var e=$(this).html();e&&translateText(e.trim(),$(this),t)})})})}window.ekomiWidgetMain=main}();